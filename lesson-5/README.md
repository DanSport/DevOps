# Terraform AWS Infrastructure (Lesson-5)

–¶–µ–π –ø—Ä–æ—î–∫—Ç —Å—Ç–≤–æ—Ä—é—î —ñ–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É –≤ AWS –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é **Terraform**.  
–í—ñ–Ω –≤–∫–ª—é—á–∞—î:

- **S3 + DynamoDB** ‚Äî –±–µ–∫–µ–Ω–¥ –¥–ª—è –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è —Ç–∞ –±–ª–æ–∫—É–≤–∞–Ω–Ω—è Terraform state.
- **VPC** ‚Äî –º–µ—Ä–µ–∂–µ–≤–∞ —ñ–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (–ø—É–±–ª—ñ—á–Ω—ñ —Ç–∞ –ø—Ä–∏–≤–∞—Ç–Ω—ñ –ø—ñ–¥–º–µ—Ä–µ–∂—ñ, Internet Gateway, NAT Gateway, —Ç–∞–±–ª–∏—Ü—ñ –º–∞—Ä—à—Ä—É—Ç—ñ–≤).
- **ECR (Elastic Container Registry)** ‚Äî —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π –¥–ª—è –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è Docker-–æ–±—Ä–∞–∑—ñ–≤.

---

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ—î–∫—Ç—É
lesson-5/
‚îú‚îÄ‚îÄ main.tf # –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –≤—Å—ñ—Ö –º–æ–¥—É–ª—ñ–≤
‚îú‚îÄ‚îÄ backend.tf # –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –±–µ–∫–µ–Ω–¥—É (S3 + DynamoDB)
‚îú‚îÄ‚îÄ outputs.tf # –ó–∞–≥–∞–ª—å–Ω—ñ –≤–∏—Ö—ñ–¥–Ω—ñ –¥–∞–Ω—ñ
‚îú‚îÄ‚îÄ variables.tf # –ì–ª–æ–±–∞–ª—å–Ω—ñ –∑–º—ñ–Ω–Ω—ñ
‚îú‚îÄ‚îÄ modules/ # –ú–æ–¥—É–ª—ñ Terraform
‚îÇ ‚îú‚îÄ‚îÄ s3-backend/ # S3 + DynamoDB –¥–ª—è —Å—Ç–µ–π—Ç—ñ–≤
‚îÇ ‚îú‚îÄ‚îÄ vpc/ # –ú–µ—Ä–µ–∂–µ–≤–∞ —ñ–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞
‚îÇ ‚îî‚îÄ‚îÄ ecr/ # –†–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π ECR
‚îî‚îÄ‚îÄ README.md # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è


---

## ‚öôÔ∏è –ú–æ–¥—É–ª—ñ

### 1. `s3-backend`
- –°—Ç–≤–æ—Ä—é—î **S3-–±–∞–∫–µ—Ç** –¥–ª—è –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è —Å—Ç–µ–π—Ç-—Ñ–∞–π–ª—ñ–≤ Terraform.
- –£–≤—ñ–º–∫–Ω–µ–Ω–æ **–≤–µ—Ä—Å—ñ–æ–Ω—É–≤–∞–Ω–Ω—è**.
- –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è **DynamoDB** –¥–ª—è –±–ª–æ–∫—É–≤–∞–Ω–Ω—è.

### 2. `vpc`
- VPC —ñ–∑ CIDR `10.0.0.0/16`.
- 3 –ø—É–±–ª—ñ—á–Ω—ñ –ø—ñ–¥–º–µ—Ä–µ–∂—ñ (–¥–ª—è –∑–æ–≤–Ω—ñ—à–Ω—ñ—Ö —Å–µ—Ä–≤—ñ—Å—ñ–≤).
- 3 –ø—Ä–∏–≤–∞—Ç–Ω—ñ –ø—ñ–¥–º–µ—Ä–µ–∂—ñ (–¥–ª—è –≤–Ω—É—Ç—Ä—ñ—à–Ω—ñ—Ö —Å–µ—Ä–≤—ñ—Å—ñ–≤).
- Internet Gateway –¥–ª—è –ø—É–±–ª—ñ—á–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø—É.
- NAT Gateway –¥–ª—è –ø—Ä–∏–≤–∞—Ç–Ω–∏—Ö –ø—ñ–¥–º–µ—Ä–µ–∂.
- –¢–∞–±–ª–∏—Ü—ñ –º–∞—Ä—à—Ä—É—Ç—ñ–≤ –¥–ª—è –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è.

### 3. `ecr`
- –°—Ç–≤–æ—Ä—é—î —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π **ECR**.
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è –æ–±—Ä–∞–∑—ñ–≤ –ø—Ä–∏ push.
- –í–∏–≤–æ–¥–∏—Ç—å URL —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—é.

---

## üöÄ –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è

### 1. –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è
```bash
terraform init


### 2. –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø–ª–∞–Ω—É
terraform plan

### 3. –ó–∞—Å—Ç–æ—Å—É–≤–∞–Ω–Ω—è –∑–º—ñ–Ω
terraform apply


(–ø—ñ–¥—Ç–≤–µ—Ä–¥—ñ—Ç—å –≤–≤–µ–¥–µ–Ω–Ω—è–º yes)

### 4. –ó–Ω–∏—â–µ–Ω–Ω—è —Ä–µ—Å—É—Ä—Å—ñ–≤
terraform destroy


## üóÇÔ∏è –†–æ–±–æ—Ç–∞ –∑ –±–µ–∫–µ–Ω–¥–æ–º (S3 + DynamoDB)

> ‚ö†Ô∏è –í–∞–∂–ª–∏–≤–æ: S3 bucket —ñ DynamoDB –¥–ª—è –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è state —â–µ –Ω–µ —ñ—Å–Ω—É—é—Ç—å –ø–µ—Ä–µ–¥ –ø–µ—Ä—à–∏–º –∑–∞–ø—É—Å–∫–æ–º.

1. –°–ø–æ—á–∞—Ç–∫—É —É —Ñ–∞–π–ª—ñ `backend.tf` –∑–∞–ª–∏—à—Ç–µ –ª–æ–∫–∞–ª—å–Ω–∏–π –±–µ–∫–µ–Ω–¥:
   ```hcl
   terraform {
     backend "local" {}
   }

2. –°—Ç–≤–æ—Ä—ñ—Ç—å —Ä–µ—Å—É—Ä—Å–∏ –¥–ª—è –±–µ–∫–µ–Ω–¥—É:

terraform init
terraform apply


–¶–µ —Å—Ç–≤–æ—Ä–∏—Ç—å S3 bucket —Ç–∞ DynamoDB table –¥–ª—è –±–ª–æ–∫—É–≤–∞–Ω–Ω—è state.

3. –¢–µ–ø–µ—Ä –∑–∞–º—ñ–Ω—ñ—Ç—å backend.tf –Ω–∞ –∫–æ–Ω—Ñ—ñ–≥ —ñ–∑ S3:

terraform {
  backend "s3" {
    bucket         = "<your-bucket-name>"
    key            = "lesson-5/terraform.tfstate"
    region         = "us-east-1"
    dynamodb_table = "terraform-locks"
    encrypt        = true
  }
}


4. –í–∏–∫–æ–Ω–∞–π—Ç–µ –º—ñ–≥—Ä–∞—Ü—ñ—é state —É S3:

terraform init -migrate-state


–¢–µ–ø–µ—Ä state –∑–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è —Ü–µ–Ω—Ç—Ä–∞–ª—ñ–∑–æ–≤–∞–Ω–æ —É S3 —ñ –∑–∞—Ö–∏—â–µ–Ω–∏–π —á–µ—Ä–µ–∑ DynamoDB locking.



üì§ Outputs

–ü—ñ—Å–ª—è apply Terraform –≤–∏–≤–µ–¥–µ:

state_bucket_name ‚Äî —ñ–º‚Äô—è S3-–±–∞–∫–µ—Ç–∞ –¥–ª—è —Å—Ç–µ–π—Ç—ñ–≤

state_dynamodb_table ‚Äî —Ç–∞–±–ª–∏—Ü—è DynamoDB

vpc_id ‚Äî ID —Å—Ç–≤–æ—Ä–µ–Ω–æ—ó VPC

public_subnet_ids ‚Äî —Å–ø–∏—Å–æ–∫ –ø—É–±–ª—ñ—á–Ω–∏—Ö –ø—ñ–¥–º–µ—Ä–µ–∂

private_subnet_ids ‚Äî —Å–ø–∏—Å–æ–∫ –ø—Ä–∏–≤–∞—Ç–Ω–∏—Ö –ø—ñ–¥–º–µ—Ä–µ–∂

ecr_repository_url ‚Äî URL ECR-—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—é


üìå –ü—Ä–∏–º—ñ—Ç–∫–∏

–†–µ–≥—ñ–æ–Ω –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º: us-east-1 (N. Virginia).

–ü–æ—Ç—Ä—ñ–±–Ω–æ –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ —ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ AWS CLI:

aws configure


–í –æ–±–ª—ñ–∫–æ–≤–æ–º—É –∑–∞–ø–∏—Å—ñ AWS –º–∞—î –±—É—Ç–∏ –¥–æ—Å—Ç–∞—Ç–Ω—å–æ –ø—Ä–∞–≤ –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è:

S3

DynamoDB

VPC/Subnets/NAT/IGW

ECR